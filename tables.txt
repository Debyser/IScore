-- Team definition

CREATE TABLE team (
	id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	name TEXT NOT NULL
);


-- Tournament definition

CREATE TABLE tournament (
	id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	name TEXT(50) NOT NULL,
	sport_type TEXT(20) NOT NULL,
	start_date TEXT NOT NULL,
	format TEXT(20) NOT NULL
);



-- Pool definition

CREATE TABLE pool (
	id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	name TEXT NOT NULL,
	pool2tournament INTEGER,
	CONSTRAINT pool_pool2tournament_fkey FOREIGN KEY (pool2tournament) REFERENCES tournament(id) ON DELETE CASCADE
);


-- "match" definition

CREATE TABLE "match" (
	id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	match2tournament INTEGER NOT NULL,
	match2pool INTEGER,
	match2team1 INTEGER NOT NULL,
	match2team2 INTEGER NOT NULL,
	team1_score INTEGER,
	team2_score INTEGER,
	match_date TEXT NOT NULL,
	CONSTRAINT match_match2pool_fkey FOREIGN KEY (match2pool) REFERENCES pool(id) ON DELETE SET NULL,
	CONSTRAINT match_match2team1_fkey FOREIGN KEY (match2team1) REFERENCES team(id) ON DELETE CASCADE,
	CONSTRAINT match_match2tournament_fkey FOREIGN KEY (match2tournament) REFERENCES tournament(id) ON DELETE CASCADE,
	CONSTRAINT match_match2team2_fkey FOREIGN KEY (match2team2) REFERENCES team(id) ON DELETE CASCADE
);

-- indexes

CREATE UNIQUE INDEX Tournament_name_IDX ON tournament (name);
CREATE INDEX match_match2tournament_IDX ON "match" (match2tournament);
CREATE INDEX match_match2pool_IDX ON "match" (match2pool);
CREATE INDEX match_match2team1_IDX ON "match" (match2team1);
CREATE INDEX match_match2team2_IDX ON "match" (match2team2);


insert into tournament (name, sport_type, start_date, format) values ('Italian Sausage Links', 'Football', '2025-09-04', 'Tournament');
insert into tournament (name, sport_type, start_date, format) values ('Black Bean Soup', 'Basketball', '2025-09-04', 'Tournament');
insert into tournament (name, sport_type, start_date, format) values ('Vegetable Spring Rolls', 'Mini-foot', '2025-09-04', 'League');
insert into tournament (name, sport_type, start_date, format) values ('Yoga Blocks', 'Basketball', '2025-09-04', 'Cup');
insert into tournament (name, sport_type, start_date, format) values ('Comfort Flats', 'Mini-foot', '2025-09-04', 'Tournament');
insert into tournament (name, sport_type, start_date, format) values ('Crispy Potato Tots', 'Volleyball', '2025-09-04', 'Tournament');
insert into tournament (name, sport_type, start_date, format) values ('Pet First Aid Kit', 'Volleyball', '2025-09-04', 'Championnat');
insert into tournament (name, sport_type, start_date, format) values ('Pet Safety Belt for Car', 'Football', '2025-09-04', 'Championnat');
insert into tournament (name, sport_type, start_date, format) values ('Cheddar Cheese Crackers', 'Football', '2025-09-04', 'League');
insert into tournament (name, sport_type, start_date, format) values ('Almond Joy Protein Bars', 'Volleyball', '2025-09-04', 'League');
insert into tournament (name, sport_type, start_date, format) values ('Fashionable Belt Bag', 'Basketball', '2025-09-04', 'Cup');
insert into tournament (name, sport_type, start_date, format) values ('Coconut Chips', 'Basketball', '2025-09-04', 'Cup');
insert into tournament (name, sport_type, start_date, format) values ('Ceramic Non-Stick Frying Pan', 'Basketball', '2025-09-04', 'Championnat');
insert into tournament (name, sport_type, start_date, format) values ('Coconut Curry Lentil Soup', 'Mini-foot', '2025-09-04', 'League');